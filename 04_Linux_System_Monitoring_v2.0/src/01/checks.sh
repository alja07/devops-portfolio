#!/bin/bash

# Проверка количества параметров
if [ "$#" -ne 6 ]; then
  echo "Ошибка: Необходимо ровно 6 параметров." >&2
  echo "Пример использования: $0 /путь/к/папке 5 az 10 file.txt 50kb" >&2
  exit 1
fi

# Проверка первого параметра (абсолютный путь)
if [ ! -d "$path" ]; then
  echo "Ошибка: '$path' не является директорией или не существует" >&2
  exit 1
fi

# Проверка второго и четвертого параметра (целые числа)
if ! [[ "$dir_count" =~ ^[0-9]+$ ]] || ! [[ "$file_count" =~ ^[0-9]+$ ]]; then
  echo "Ошибка: Количество папок и файлов должно быть целым положительным числом" >&2
  exit 1
fi

# Проверка третьего параметра (1-7 английских букв)
if ! [[ "$dir_chars" =~ ^[a-zA-Z]{1,7}$ ]]; then
  echo "Ошибка: Символы для папок должны быть 1-7 букв английского алфавита" >&2
  exit 1
fi

# Проверка пятого параметра (формат name.ext)
if ! [[ "$file_template" =~ ^[a-zA-Z]{1,7}\.[a-zA-Z]{1,3}$ ]]; then
  echo "Ошибка: Шаблон файла должен быть в формате 'name.ext' (1-7 букв.имя.1-3 букв.расширение)" >&2
  exit 1
fi

# Проверка шестого параметра (число 1-100)
if ! [[ "$file_size_kb" =~ ^[1-9][0-9]?$ ]] || [ "$file_size_kb" -gt 100 ]; then
  echo "Ошибка: Размер файла должен быть числом от 1 до 100" >&2
  exit 1
fi

# Функция проверки дискового пространства
check_disk_space() {
  free_space_gb=$(df -BG / | awk 'NR==2 {print $4}' | tr -d 'G')

  if [ "$free_space_gb" -lt 1 ]; then
    echo "Ошибка: Осталось меньше 1 ГБ свободного места." >&2
    exit 1
  fi
}
